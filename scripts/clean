#!/bin/bash

# Clean script for Journal Index Integration
# Usage: ./scripts/clean [--all]

set -e

# Colors
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

log_info() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

log_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

log_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

CLEAN_ALL=false

# Parse arguments
if [[ "$1" == "--all" ]]; then
    CLEAN_ALL=true
fi

log_info "Cleaning project..."

# Maven clean
if [ -f "pom.xml" ]; then
    log_info "Running Maven clean..."
    mvn clean
    log_success "Maven clean completed"
fi

# Clean Serverless artifacts
if [ -d ".serverless" ]; then
    log_info "Removing .serverless directory..."
    rm -rf .serverless
    log_success "Serverless artifacts removed"
fi

# Clean IDE files if --all is specified
if [ "$CLEAN_ALL" = true ]; then
    if [ -d ".idea" ]; then
        log_warning "Removing .idea directory..."
        rm -rf .idea
    fi
    
    if [ -d ".vscode" ]; then
        log_warning "Removing .vscode directory..."
        rm -rf .vscode
    fi
    
    if [ -f "*.iml" ]; then
        log_warning "Removing IntelliJ module files..."
        rm -f *.iml
    fi
    
    log_success "IDE files removed"
fi

log_success "âœ… Project cleaned successfully!"

if [ "$CLEAN_ALL" = true ]; then
    log_info "To rebuild, run: mvn clean package"
fi

